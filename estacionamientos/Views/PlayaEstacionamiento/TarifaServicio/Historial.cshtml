@model List<estacionamientos.ViewModels.TarifaHistGroupVM>
@{
    ViewData["Title"] = "Historial de tarifas";
}

<style>
/* Reusar el estilo de Playeros */
.period-list { list-style: none; margin: 0; padding: 0; display: flex; flex-direction: column; gap: .4rem; }
.period-chip { --bg:#f5f5f5; --fg:#333; --bd:#e5e5e5; display:inline-flex; align-items:center; gap:.5rem; padding:.45rem .75rem; border-radius:.75rem; background:var(--bg); color:var(--fg); border:1px solid var(--bd); font-size:.9rem; line-height:1.1rem; width:fit-content; }
.period-chip .dot { width:.55rem; height:.55rem; border-radius:50%; background:currentColor; opacity:.8; }
.period-chip.vigente { --bg:#eaf6ee; --fg:#1f5133; --bd:#cfe9d7; }
.period-chip.finalizado { --bg:#fdecee; --fg:#7a232d; --bd:#f6c8cd; }
.centrado-servicio {
    display: table-cell;
    text-align: center; /* Centra horizontalmente */
    vertical-align: middle; /* Centra verticalmente */
    height: 100%;            /* Asegura que ocupe toda la altura de la celda */
}


</style>

<div class="container">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="mb-0">@ViewData["Title"]</h2>
            <a asp-action="Index"
            asp-route-plyID="@ViewBag.PlyID"
            class="btn btn-outline-secondary">
                <i class="fa-solid fa-arrow-left"></i> Volver
            </a>
    </div>

    <table class="table table-striped align-middle">
        <thead class="table-light">
            <tr>
                <th style="width: 25%;">Servicio</th>
                <th>Períodos</th>
            </tr>
        </thead>
        <tbody>
        @if (Model?.Count > 0)
        {
            foreach (var r in Model)
            {
                <tr>
                    <td>
                        <div class="centrado-servicio">@r.ServicioNombre</div>
                    </td>
                    <td>
                        <ul class="period-list">
                            @foreach (var p in r.Periodos.OrderByDescending(x => x.Vigente).ThenByDescending(x => x.FechaInicio))
                            {
                                var clase = p.Vigente ? "vigente" : "finalizado";
                                var ini = p.FechaInicio?.ToString("dd/MM/yyyy") ?? "—";
                                var fin = p.FechaFin.HasValue ? p.FechaFin.Value.ToString("dd/MM/yyyy") : "Vigente";
                                <li>
                                    <div class="period-chip @clase">
                                        <span class="dot"></span>
                                        <span>
                                            <strong>@p.ClaseVehiculo</strong> • $@p.Monto • @ini → @fin
                                        </span>
                                    </div>
                                </li>
                            }
                        </ul>
                    </td>
                </tr>
            }
        }
        else
        {
            <tr>
                <td colspan="2" class="text-center text-muted">Sin historial.</td>
            </tr>
        }
        </tbody>
    </table>
</div>
